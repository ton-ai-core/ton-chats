# The Open Dev Blog (ID: 2154553559, Type: public_channel)

— 2024-08-11 —

Unknown: Условное выражение с отрицанием в Func выглядит как  ifnot () {  }  Николай Дуров великий

Unknown: Немного забавных фактов - у ston.fi нет роутинга. Вообще. У них нельзя обменять токены, у которых нет своего общего пула ликвидности.  Более того, если ты ему пришлешь на обмен токен, пула для которого у ston.fi нет, то их роутер просто зажмет бабки и ничего тебе не вернет.  P.S у дедаста роутинг есть

Unknown: С роутингом на тоне связана интересная особенность, присущая чисто тону.   У swap.coffee была история, когда при свапе условного $DUREV на $PLANE пользователю почему то приходил токен $DFC. А дело вот в чем - swap.coffee подбирал наиболее выгодный пользователю роут свапа, и ребята из $DFC научились быть всегда самым выгодным посредником при свапе. Однако после свапа $DUREV в $DFC, при втором обмене уже токена $DFC на $PLANE, срабатывал слипадж, и пользователю возвращался его посредник — $DFC. В эфире при такой ошибке отменился бы весь чейн транзакций, а в тоне это невозможно.   Поэтому может это осознанное решение ston.fi - отказаться от роутинга. Непонятно только, почему токены не возвращает. (reply to 5)

— 2024-08-12 —

Unknown: Никто с этим ничего не сделает, в этом даже в среднем нет ничего плохого, но все же об этом я нигде не читал.  У ston.fi есть официальная опция обновления кода смарт контракта. Разумеется, ончейн проверить, сильно ли отличается новый код от старого, невозможно, поэтому чисто формально новый смарт контракт может быть любым, при этом оставаясь на том же адресе.  https://github.com/ston-fi/dex-core/blob/main/contracts/router/admin-calls.func#L76  В этом нет ничего особо страшного, многие блокчейн проекты этим грешат.  Только клубу 100 не показывайте

— 2024-08-13 —

Unknown: В публичном поле страшно не раскрыта тема того, к какому количеству, в том числе и приватных, чатов имеет доступ xRocket и другие кошельки наподобие его.  Я не удивлюсь, если на каком-то этапе своего развития основной заработок подобных проектов будет не с оборота средств внутри них, а с торговли по инсайдам, которые у них скапливаются, просто потому что их ботом пользуются в различных приватках/закрытых чатах.

— 2024-08-14 —

Unknown: Есть важный факт, о котором все забывают при предсказании курса Ton. Понятно, почему забывают - если принимать в расчет эту информацию, то попытки предсказания курса становятся бессмысленными.  БОльшая часть эмиссии Ton-а, скорее всего, находится в руках, под контролем или под влиянием маркетмейкера. Это означает, что DWF Labs способны сделать с графиком Ton вообще что угодно. Поэтому рассуждать нужно не с позиции "а что у нас случится в ближайшее время на блокчейне?", а "к какому событию маркетмейкер должен будет сделать максимальный хайп?". Бычий рынок на Ton-е в начале весны был подготовкой к приходу Tether на Ton. Хочешь-не хочешь, но если стоимость актива (Ton-а) растет в 4 раза, хайп будет неизбежен, а именно это и нужно было, чтобы максимально осветить такую крупную новость. При всём этом, про приход Tether на Ton я слышал или слухи, или предположения, или всё вместе еще в феврале. В ноябре состоится конференция The Gateway в Дубае (кстати пишите, пообщаемся там). Основной вопрос по курсу - будет ли на этой конференции, посвященной Ton-у, какой-то крупный анонс, под который нужно разгонять хайп. Я предположу, что на конференции запустят L2 сеть для Ton. Анонс уже был, информации достаточно, главный вопрос - успеют ли доделать к конференции? Если решат, что успевают, то нас ждет бычка в следующие 2 месяца, а на конференции опять будет -10-15% от курса. И даже не потому, что "покупай на слухах, продавай на новостях", а потому что такая у DWF Labs стратегия маркетмейкинга Ton-а  Если я прав, то недавний дамп Ton-а был связан именно с началом искуственной бычки. Пампить легче с 5.5, чем с 8 )  Вот такая вот неприятная правда. (моё оценочное суждение, по моей непроверенной информации)  UPD: вчера написал пост, сегодня Ton подскочил, забавно

— 2024-08-17 —

Unknown: Почему ломается ликвидность на ston fi?  Во время бычки весной многие проекты столкнулись со "снайпингом ликвы" именно на ston fi. И это не тот снайпинг, где "купил пораньше, продал пораньше", как это часто было на dedust-е, а это была возможность под чистую сломать пул при заливе ликвидности, сделав невозможным обменивать токены друг на друга.  В отличие от dedust, залив ликвидности у ston fi очень простой - просто присылаешь токены и всё, можно менять. Однако есть нюанс: начальную ликвидность, присланную при самом первом заливе, вывести нельзя (код). Эдакое автосжигание прав на ликвидность, можно сказать.  Но авторы проектов нашли, как выкрутиться - они заливали как начальную ликвидность очень малое количество токенов, таким образом почти ничего не теряя. И уже второй транзакцией они досылали основную ликвидность.  И вот тут появились умельцы, которые, иногда случайно, а иногда специально, пытались купить токен между первой и второй транзакцией. Из-за маленьких сумм изначальной ликвидности соотношение одного актива к другому резко скакало, что делало невозможным залить новые токены, ведь пока ты их будешь отправлять, цена еще скакнёт, и твой залив ликвидности уже неактуален, и так до бесконечности.  Многие думали (я тоже, кстати), что это происходит из-за того, что один из активов выходит полностью, но это не так, от этого есть защита в коде.  Пример снайпа ликвы.

Unknown: На подумать: Когда какой-либо проект обещает сжечь права на ликвидность токена, но при этом заливает её в 2 транзакции на ston fi, у осознанной части сообщества должны появиться вопросы, ведь можно залить в 1 транзакцию без угрозы снайпа ликвы и со сразу сожжёнными правами. То есть либо автор токена некомпетентен, либо нечист на руку.  Кстати ни одного токена, который бы так по честному сделал, я не видел.  Думайте. (reply to 11)

Unknown: Если у кого-либо при мыслях о том заливать ли ликвидность для фарма на ston fi возникало недоумение, почему в интерфейсе не пишется как долго ещё будет продолжаться буст пула - то есть небольшой лайфхак:  1. Заходите на страницу с пулов в браузере 2. Открываете инспектор в браузере на network, обновляете страницу 3. Ищите запрос на rpc.ston.fi с методом "farm.balance_list_by_pool"  В ответе будет куча инфы, которую по каким-то причинам решили не показывать в интерфейсе: сколько ликвы участвует в фарме, какой минимальный срок через который можно будет вывести ликву и самое главное какой рейт раздачи наград и сколько ещё осталось, удачного диора!

— 2024-08-18 —

Unknown: Как сайты-обозреватели блокчейна понимают, какой перед ними контракт?  Tonviewer часто пишет у себя так называемый "Сontract type" на странице с информацией о каком-либо адресе в блокчейне. Пример, еще пример.  Никто без посторонней помощи не может напрямую прочитать код контракта из сети, как бы вас не убеждали в прозрачности всей системы. Обозреватели блокчейна просто ищут определенные get-методы в контракте, которые можно вызывать, зная название метода. У разных контрактов есть разные ключевые get-методы, по которым обозреватели блокчейна его определяют. У кошелька с жеттонами это "get_wallet_data", у контракта токена - "get_jetton_data" и т.д  Таким образом, на самом деле если tonviewer или tonscan пишут, что перед вами jetton_wallet, то есть кошелек с жеттонами, это вовсе не означает, что вы в безопасности. Это может быть кошелек, с которого злоумышленник в любой момент может вывести все средства, это может быть вообще не кошелек, а какой-то совсем другой контракт.  И если кто-то убеждает вас, что tonviewer "аппрувнул" его контракт, подписав его тип - это либо некомпетентность, либо попытка обмана вас.  Для примера написал простенький контрактик, который определяется tonviewer-ом тремя разными типами. Судя по всему, больше трёх он не умеет отображать, а так бы сделал все типы сразу. Вот его адрес: https://testnet.tonviewer.com/kQDa7hIG0U4swiXmRJ6014vR8EDJQGFLcGEqr8Fxvoi_SCAM

— 2024-08-19 —

Unknown: Немногие знают, это в целом какая-то странно непопулярная информация, что на Ton можно взять себе адрес с красивым окончанием. Например, контракт к прошлому посту имеет окончание "_SCAM". Из известных контрактов можно ещё вспомнить адрес токена $SCALE - EQBlqsm144Dq6SjbPI4jjZvA1hqTIP3CvHovbIfW_t-SCALE.  Причём это не ещё один финансовый рычаг Дурова, их нигде не продают (хотя можно попробовать!). Эти адреса можно посчитать.  Вообще для этого есть репозиторий на github. Если вы разбираетесь, то пользуйтесь.  Красивый адрес контракта ничего, конечно, не означает. Любой скамер может намайнить себе адрес "..._CHECKED" (при наличии у него достаточной мощности, она нужна немалая), и занять его для своих будущих злодеяний. Поэтому не ведитесь на (иногда недешевый) понт.

Unknown: Чекеры контрактов  Канал @skamshot попросил нас разобрать тему полезности и возможности нахождения ханипотов в контрактах в контексте блокчейна Ton.  Первое, что нужно понимать - код контракта, который вы можете найти на github и информация, которая хранится в блокчейне - это разные сущности. Это работает так и на Ton, и на EVM блокчейнах (Ethereum, Polygon, Avalanche).  Это происходит из-за того, что код, который программисты пишут, "компилируется", то есть перегоняется из человекочитаемого формата в машиночитаемый - нули и единицы, которые распознаются виртуальной машиной блокчейна как инструкции к работе. Именно поэтому просто взять и прочитать, что делает контракт, пользуясь только глазами, не получится.   На EVM блокчейнах для этого есть довольно развитая индустрия "декомпиляторов" - программ, которые из машиночитаемого формата пытаются сделать человекочитаемый. Это нетривиальная задача, причем ее нетривиальность довольно сложно объяснить, поэтому пропустим.  На Ton-е лично я видел что-то подобное, но страшно сырое, поэтому считаю, что декомпиляторов на Ton-е пока нет. При этом никакая архитектурная особенность не мешает им появиться в будущем.

Unknown: Поэтому единственный способ проверить, что делает контракт - это "эмулировать" транзакцию, то есть имитировать работу контракта, основываясь на его машиночитаемой версии.  На Ton-e это возможно. Поэтому сделать проверку ханипотов вполне реально. Например, есть @ruton_checker_bot. Я не могу ручаться за его достоверность, но знаю нескольких людей, которые им пользуются. Создатель отказался выдавать нам, какие проверки его бот проводит. Это хороший знак. За сколько-то звёзд можем сделать стресс тест этого бота - определит ли он ханипоты, которые мы напишем?  Однако важно понимать несколько деталей. Что на Ton, что на EVM сетях, что на Solana невозможно программно полностью защититься от ханипотов или ошибок в написании контракта. Ситуаций, где у пользователей заберут все деньги, может быть неисчислимо много. Например, контракт даёт покупать и продавать до какого-то времени или блока, или имеет возможность накрутить владельцу количество токенов.  Более того, у Ton-а есть скам преимущество относительно других сетей. На FunC есть функция, позволяющая сменить код контракта на любой другой. На EVM сетях такого нет, чтобы изменить код там, нужно идти на ухищрения, которые легко заметить постороннему человеку. Таким образом, благодаря этому "преимуществу" Ton, любой из известных вам непубличных контрактов в сети в любой момент может сменить свой код и вывести все ваши деньги. Например, такая возможность есть у ston fi.  Но как же тогда доверять кому-либо? Для этого проекты открывают свой код и предлагают всем желающим найти в нём ошибки. Так сделал, например, тот же ston fi. На Ton-е эта культура пока что не развита, но мы обязательно к ней придём путём проб и ошибок. (reply to 17)

— 2024-08-21 —

Unknown: Разработчики централизованных приложений (например, кликеров с последующим минтом токенов), работающих с блокчейном, всегда могут (и, по-моему, должны) снять с себя обязанность платить комиссию за админские действия, которые делаются для пользователя. Например, вывод средств или минт токенов, но при каком-то оффчейн условии.  Возникает вопрос - а как, например, сделать ончейн минт токенов при условии, что пользователь накликает 10к раз в оффчейн кликере? Ответ прост. Пользователь сам может сообщать смарт-контрактам о выполненном условии, отправлять транзакции и выводить свои средства, исполняя при этом по сути админские функции.  Возникает второй вопрос - как помешать пользователю вывести все средства с контракта или сминтить себе весь саплай, если он исполняет обязанности админа и отправляет за него транзакции? Для этого в Ton-е (и он в этом не одинок) существует механизм permit-а. Бэкенд приложения подписывает для пользователя сообщение, которое он отправляет в смарт-контракт (и выплачивает комиссию блокчейна). Пользователь не может изменить сообщение, поскольку оно подписано приватным ключом шифрования (грубо говоря, мнемоник фразой, как от вашего tonkeeper) на бэкенде. Нашей мнемоник фразы у пользователя нет, поэтому подписать другое сообщение за нас пользователь не может.  Это можно сравнить с банковскими чеками, которые использовались в 19-20 веках. Ваш друг брал свою чековую книжку и выписывал на ваше имя чек. Вы с этим чеком приходили в банк и получали деньги. Комиссией блокчейна в этой ситуации можно считать прогулку до банка). В EVM блокчейнах по аналогии был даже придуман отдельный тип токена - ERC-2612. Что-то подобное хотел на досуге написать для Ton-а. Бумажные чеки, конечно, было подделать очень легко. Permit-ы подделать с нынешними вычислительными мощностями фактически невозможно, поэтому можно быть спокойным.  Правда, в процессе внедрения подобного механизма в смарт-контракты можно накосячить примерно 350 раз. Но об этом расскажу из личного опыта как-нибудь в другой раз)

— 2024-08-24 —

Unknown: #freeDurov

— 2024-08-26 —

Unknown: Нам стоит написать, если:  ⚫️ Вам нужна разработка ончейн или частично ончейн решения для вашего продукта. Например, необычного токена с бэкендом, отвечающим за это.  ⚫️ Вы хотите получить консультацию/аудит по проектировке или безопасности вашей архитектуры/готового решения.  ⚫️ Вы админ канала/медиа и хотите получить комментарий, разбор по интересующей вас теме, связанной с глубоким пониманием работы блокчейна Ton или проектов на нём.  По всем этим вопросам можно написать контактам в био канала.

— 2024-08-27 —

Unknown: Уязвимость в коллаборации EVAA и coffee swap  На позапрошлой неделе EVAA запустили у себя в приложении возможность свапа токенов на базе dex агрегатора coffee swap. По сути это просто другой интерфейс для swap.coffee, однако в рамках коллаборации за каждый свапнутый доллар  пользователю начисляются EVAA XP и токены кофисвапа $CES (но не более чем какое-то количество на одного пользователя в сутки).  Сам по себе фарм XP и $CES на легитимных свапах большого смысла не имеет, поскольку на комиссии блокчейна\комиссии ston fi\dedust уходило скорее всего бы больше токенов при свапах, чем сколько можно было бы получить $CES (ну а с EVAA XP вообще сложно было бы просчитать экономическую целесообразность).   Однако присутствовала небольшая простая уловка, благодаря которой можно было бы спокойно получать по 10$ и 25к XP в день на адрес без больших затрат. Схема заключается в том что можно было спокойно создать собственные 2 токена, залить для обоих из них совершенно небольшую ликвидность к, например, тону, также затем залить ликвидность между двумя этими токенами. Таким образом, когда мы попытались бы обменять эти токены друг к другу, то бэкенд кофисвапа оценивал цены обоих токенов по той небольшой ликвидности, которую бы мы залили к тону, а вот саму возможность свапать токены друг на друга осуществлял бы пул ликвидности между двумя токенами, благодаря чему их цена бы по сути не менялась в долларовом эквиваленте.  Информация была передана команде EVAA (и также команде swap.coffee через них). Бага была исправлена уже почти неделю назад, спасибо им за оперативность🫡.

— 2024-08-30 —

Unknown: Сколько заработал Dedust на бустах пулов?  Немногие знают, но dedust берёт комиссию в 0.5% от буста своих пулов (от тех, которые идут не от TON Foundation). То есть все средства, которые можно нафармить предоставляя ликвидность в пулы изначально облагаются налогом в 0.5% и идут напрямую на кошелёк, контролируемый командой dedust.  Суммарно dedust заработал только на этих комиссиях приблизительно 91.000$ по нынешнему курсу токенов (на самом деле чуть меньше из-за того что часть этих токенов сами по себе малоликвидны). Это означает что суммарные бусты пулов от пользователей составляют около 18м$.  Основную часть составляют бусты в токенах Hydra (наверняка вы видели реварды в них во многих пулах ликвидности), а также из крупных SCALE (токен самого dedust), TOM (малоликвидный токен), JETTON (планово хотят раздать на бусты где-то 10% от всего саплая токена)  Также из интересного - dedust не разрешает пользователям бустить пулы при помощи TON, USDT. А токены, которыми можно это делать находятся в вайтлисте.

— 2024-08-31 —

Unknown: Упавшая транзакция (то есть failed) еще не означает, что изменения в память контракта не были внесены.  Мы все привыкли, что если контракт упал при исполнении, то нам возвращается или не возвращается bounce, и никакие изменения, касающиеся этого контракта, кроме баланса контракта и упавшего сообщения, в блокчейн не вносятся.  Это не так. В FunC есть великолепная функция commit(), которая позволяет сохранить состояние в блокчейне, даже если после вызова этой функции контракт упал. Это помогает в сложных структурах контрактов, когда, например, нужно вернуть деньги пользователю с контракта, который напрямую с пользователем не взаимодействует (и поэтому bounce не сработает).  А еще так можно скамить) Прикрываться упавшей транзакцией, делая вид, что, например, не получилось сменить админа токена. Не ведитесь на уверения, что "так быть не может" (на EVM блокчейнах так действительно не может быть).  Для примера написал простенький контракт. Вот так он работает - транзакция упала, но он все равно отправил аж 3 сообщения на другие адреса, и ни одно из них не bounce.

— 2024-09-06 —

Unknown: Как зайти в Storm Trade от имени любого пользователя?  Когда вы заходите на шторм трейд, для каждого пользователя должен отрисоваться интерфейс со всеми актуальными трейдами, ликвидностью в пулах, RP, ачивками и тд.   Так как у шторм трейда нет никакой авторизации помимо ton connect (обычного подключения кошелька), то абсолютно любой может посмотреть интерфейс и всю актуальную информацию (включая, например выставленные стоп лоссы, тейк профиты, цены ликвидаций позиций) абсолютно любого другого пользователя. Сделать это достаточно просто:  1. Подключаете свой кошелёк в браузере 2. Находите адрес кошелька пользователя, от имени кого вы хотели бы посмотреть интерфейс шторм трейда 3. Открываете Developer Tools (F12\command+option+I) и вписываете в консоли window.tonConnect.connector.account.address = ‘нужный вам адрес’  В целом это может быть полезно для снайпинга залива ликвидности - чтобы, например, подгадывать моменты, когда вот-вот должно ликвидировать очень крупную позицию и вся его margin пойдёт в vault для поставщиков ликвидности (ну или наоборот чтобы выводить ликвидность когда удачного трейдера вот-вот сработает take profit на большую позицию)  Адреса трейдеров можно смотреть по транзакциям на волты с опкодом 0xe0db7753:  TON Vault - https://tonviewer.com/EQDpJnZP89Jyxz3euDaXXFUhwCWtaOeRmiUJTi3jGYgF8fnj USDT Vault - https://tonviewer.com/EQAz6ehNfL7_8NI7OVh1Qg46HsuC4kFpK-icfqK9J3Frd6CJ NOT Vault - https://tonviewer.com/EQAG8_BzwlWkmqb9zImr9RJjjgZZCLMOQXP9PR0B1PYHvfSS  Либо также как вариант: в tonviewer можно смотреть на самых крупных держателей SLP токенов, чтобы увидеть кто сколько из китов заработал на предоставлении ликвидности  На самом деле тут большой простор для реализации снайпер бота, который будет подсказывать когда лучше заводить и выводить ликвидность - но необходимо полностью учитывать математику всех видов комиссий шторм трейда при самостоятельной индексации этих контрактов, либо же полагаться на api шторм трейда, что, конечно, не так надёжно, зато проще.

— 2024-09-12 —

Unknown: Пост про новый стандарт в TON готовится, а пока завезли для вас разбор интересного способа скама, которым с нами поделился наш подписчик.  Суть проста - кнопка "отправьте нам весь ваш баланс, получите 500к, 1кк, 1ккк долларов, сколько захотите". И действительно - пользователь нажимает кнопку и видит эмуляцию транзакции как на скрине - он отправляет N ton, а получает несметные богатства.  На удивление это очень продвинутый способ скама, для которого нужно подкорректировать смарт-контракт jetton-wallet. Нужно внести два изменения: сделать так, чтобы любой юзер мог пользоваться любым кошельком жетона, и чтобы при отправке жетонов они не вычитались из баланса. (для всего этого нужно удалить 3 строчки в коде контракта jetton-wallet)  Пользователь отправляет деньги на адрес чужого(!) кошелька с жетонами с указанием отправить себе 500к токенов (сколько угодно, зависит лишь от жадности). Кошелек жетонов отрабатывает согласно новому коду - не проверяет, кто прислал транзакцию, и послушно "пересылает" 500к жетонов отправителю. Коды операции совпадают с пересылкой жетонов, и обозреватели блокчейна отображают это как обычный трансфер. Все это становится возможным, т.к мы ранее поменяли смарт-контракт, и он больше не проверяет, есть ли у него на балансе нужная сумма.  Но почему же tonkeeper определяет этот токен как USDT, и даже подписывает цену токена? Тут всё просто - при деплое кошелька жетонов мы указали jetton_master оригинального USDT, и поэтому обозреватели блокчейна определяют его как настоящий доллар.  Написал и опубликовал пример кода, с которого был сделан скриншот. Для того, чтобы им скамить, нужно вносить дополнительные правки, поэтому никому я этим жизнь не упрощаю. !!! Осторожно, не пользуйтесь этим кодом, если не разбираетесь в его работе досконально, вы можете безвозвратно потерять свои деньги !!!  Это не единственный способ скамить таким образом, я лишь продемонстрировал самый простой вариант. Всегда проверяйте адрес сайта, на котором вы находитесь, и не доверяйте вслепую тому, что вам рисуется на экране.  @theOpenDevBlog

— 2024-09-13 —

Unknown: Как узнать, что смарт-контракт внёс какие-то изменения в блокчейн, даже если он упал при исполнении?  Всё просто - в tonviewer можно посмотреть так называемую action фазу. Если ее нет, или она "skipped", то контракт никаких изменений не вносил. Например, как тут.  (нужно нажать на кружочек с восклицательным знаком и посмотреть на информацию внизу 😬) Как видите, compute фаза есть, а справа от нее пусто.  А вот в случае с моим контрактом, несмотря на ошибки при исполнении кода, action фаза отображается. При этом можно заметить, что "total actions" указано как 3, то есть за каждое исходящее сообщение было совершено одно действие (action). Таким образом, смарт-контракт в свои данные никаких изменений не вносил, только отправил 3 сообщения.  Если "total actions" больше, чем число исходящих сообщений, то смарт-контракт внёс изменения в свои ончейн данные.  @theOpenDevBlog (reply to 29)

— 2024-09-15 —

Unknown: Сколько Aqua Protocol заработал с минта Nomis Score NFT?  В июле этого года к окончанию фарминга в боте Aqua Protocol был приурочен минт Nomis Score - NFT, показывающий "рейтинг" вашего кошелька. Разумеется, это была рефералка - минт одной NFT стоил 1.1 TON, часть средств уходило создателям проекта, а часть - человеку, который привёл аудиторию, то есть на кошелёк julia-innovator.ton.   Экономика такая: для обычного юзера награда за реферала 0.1 TON, но для julia-innovator.ton наградой было 50% от общей прибыли протокола (примерно 0.5 TON).  Реализовано все это в духе нашего поста про подписи. Пользователь получает параметр signature, который передается в транзакции от его кошелька, и который не позволяет подделать данные в сообщении.  На удивление, Aqua заработал с этой активности всего 774 тона, приведя при этом 1586 пользователей. Эти данные только из смарт-контрактов Nomis, платили ли они дополнительно - неизвестно. Сами же основатели Nomis заработали 21488 TON, судя по данным блокчейна. По нынешнему курсу это порядка 122к$.  Данные взяты из re::doubt.  Friendly remainder - ничего, разумеется, криминального в рефералке нет, но это нигде не афишировалось, и я очень удивился, когда это увидел.

— 2024-09-18 —

Unknown: С постом про стандарт я немного запоздал, т.к хотелось максимально подробно всё рассказать. Но чем больше углублялся, тем больше понимал, что адекватно это в пост не впихнёшь, поэтому напишем обзорную часть.  Недавний релиз мемкоина $DOGS снова подсветил проблему с архитектурой централизованного минта жетонов при аирдропах. Если число юзеров достаточно большое, то объективно никаких мощностей любого блокчейна просто физически не может хватить, если при минте жеттонов участвует один адрес - jetton-master.  Для решения такой проблемы недавно появился новый стандарт жетона на TON - mintless jetton (вот код). Как он работает: минт токенов больше не происходит через jetton-master, а он получается каждым участником аирдропа через его собственный jetton-wallet.   Реализовано это через механизм дерева Меркла (я советую прочитать это, если вы не знаете, что это такое). Механика работы следующая - каждый jetton-wallet хранит у себя переменную mercle_root, то есть хэш, находящийся на верхушке дерева. При получении аирдропа пользователь должен предъявить свой mercle_proof, то есть некоторое криптографическое доказательство, что пользователь в аирдропе участвует. При этом никакой централизованной системы не участвует, каждый jetton-wallet обладает всей полнотой информации, чтобы подтвердить право пользователя на аирдроп. Важно понимать - разумеется, вы ничего подобного при обычном получении аирдропа не увидите, поскольку логика работы, конечно же, будет и должна находиться под капотом приложения, которое отвечает за аирдроп.  Таким образом, при получении своих токенов с точки зрения блокчейна вы будете обращаться не к jetton-master-у, как обычно, а к своему jetton-wallet-у. Его код никак не подменить, несмотря на то, что он "типа ваш". Разумеется, обычный минт тоже присутствует, и ничего не ограничивает владельца токена в обход аирдропа сминтить себе дополнительные токены.  Надо признать, что этот стандарт является по настоящему новым словом в децентрализации. Несмотря на весь fud в сторону TON, в действительности такой пользовательской базы, какая есть у тех же $DOGS, нет больше нигде. И в условном эфире при похожей нагрузке на блокчейн комиссии за обычные транзакции бы подскочили до сотен долларов, как это было, например, во время халвинга биткоина.

Unknown: Скоро будет пост о крутой найденной уязвимости в одном из протоколов на Тоне, а также о том, что не всегда стоит воспринимать факт проведённого аудита слишком серьёзно😐

— 2024-09-20 —

Unknown: Критическая уязвимость в Tradoor.io  Не все знают, но в TON-е существует прямой конкурент Storm trade, на котором можно также торговать perpetuals на различные криптовалюты.  И интересной отличительной чертой является возможность торговать опционами, причём очень короткими, начиная с 5-минутных.  Суть торговли опционами заключается в том, что они потенциально могут дать вам большее плечо, чем обычные perpetuals, а также твоя позиция не будет ликвидирована до конца истечения опциона. Однако есть минусы, заключающиеся в том, что, закрыв опцион по той же цене, что ты его и покупал, ты потеряешь все деньги, то есть цена актива должна изменится на стоимость опциона для того, чтобы хотя бы окупить траты.  Не буду вдаваться в подробности, как именно должна рассчитываться справедливая стоимость опционов различной длительности (вкратце, чем выше волатильность, тем дороже в моменте должен быть опцион), так в чём же заключается уязвимость?  Когда я решил проанализировать, что же передаётся в контракт при покупке опциона, оказалось, что туда прямо из пользовательского интерфейса передаётся и стоимость опциона, и количество купленых опционов, и много другой интересной информации. После нескольких попыток отправки транзакций с измененными вручную значениями оказалось, что их индексером при открытии транзакции совершенно не проверялась цена, по которой происходит покупка, поэтому появлялась возможность купить опцион на любой срок и любой стоимости. А это значит..? Верно, бесконечное плечо!  Пример - на скриншоте я купил PUT опцион на 5 минут с плечом ~43,000х. Но открыть опцион, очевидно, можно было на любой срок и абсолютно любым плечом. Суть в том, что открыв CALL и PUT опцион с огромным плечом одновременно, пользователь мог получить буквально бесплатные деньги, поскольку для выхода позиции в огроменный плюс было достаточно абсолютно любого минимального изменения цены в любую сторону.  Это означает возможность вывода ВСЕЙ ликвидности из волта опционов, совершив всего две сделки за 20$!  Я сразу попробовал связаться с командой через их бота поддержки, написал им про существующую уязвимость, и хоть ответа я так и не получил - буквально спустя пару часов они отключили индексер, а на следующее утро уязвимость уже была исправлена, теперь при попытке покупки опциона по произвольной цене вам просто вернутся ваши USDT. Конечно жаль, что команда не захотела отвечать на мой репорт, но исправили очень оперативно, за что ребятам респект. Если у кого-то есть контакты фаундеров, скиньте в лс, а то сам я не нашёл ничего кроме их чата, где не хочется наводить fud.  А эти заработанные 90$ в сделке при помощи бага я уже слил обратно, тестируя их протокол дальше ☹️  @theOpenDevBlog

Unknown: Про аудит: у них на лендинге можно найти проведённый в мае этого года аудит от tonbit.  И вроде бы всё прекрасно - проаудировали какие-то контракты, нашли какие-то уязвимости, команда их всех успешно исправила. Однако заметьте, насколько бы подробно вы не пытались прочитать и вникнуть в этот отчёт, у вас не получится этого сделать: ⚫️ На исходный год на гитхабе доступа нет. ⚫️ Из описания найденных уязвимостей имеются только краткие названия, которые мало о чём говорят. ⚫️По названиям файлов, которые были предоставлены для аудита даже не поймёшь, какой именно функционал проверялся. ⚫️ Проверялся ли сам бэкенд\индексер? Видимо нет.  Это не к тому, что tonbit плохо проводит аудиты, или tradoor специально кого-то обманывает. Очевидно, что за прошедшие 4 месяца они успели дописать много функционала, в том числе, возможно, и опционы, которые они вряд ли успели должным образом проверить.  Однако на первый взгляд кажется, что раз аудит есть, то всё должно быть супер. Всегда проводите dyor всего сами, в том числе и проверяйте публично доступные аудиты!  А если вам нужна консультация по вашим проектам в тоне, то можете писать нам 🙂  @theOpenDevBlog (reply to 40)

— 2024-09-22 —

Unknown: В преддверии большого поста про шардинг важный совет ончейн проектам на TON-е.  С недавних пор шардинг в TON-е наконец то заработал! Это означает, что если на какой-то из шардов блокчейна (частей, на которые делится блокчейн) ложится нагрузка, которую он неспособен обработать, то ложится исключительно этот шард. Раньше, как все мы помним, ложился весь блокчейн.  Это означает, что теперь просто банально невыгодно находиться в одном шарде с, например, роутером ston.fi, поскольку их архитектура смарт-контрактов подразумевает, что каждый пользователь их платформы отправляет сообщение на этот адрес. Поэтому при больших нагрузках именно шард со ston.fi потенциально будет ложиться.  Крупным (и не только) проектам надо об этом задумываться и калькулировать адреса своих контрактов так, чтобы точно в один шард с потенциально высоконагруженными адресами не попадать. Это несложно - аккаунты распределяются по шардам в зависимости от первых бит адреса. На скрине это правый столбец - маска адреса в шарде. Эту информацию можно посмотреть тут.

— 2024-09-29 —

Unknown: 🎉 TheOpenDevBlog поучастовал в TonBit CTF 2024!  Решили проверить свои силы и оказались довольны результатом. Мы решили все задания, заняли 6-ое место, потратив на это не так много времени, как хотелось бы.  Подозреваем, что на этом канале мы не раз еще будет лить fud на TonBit, и этот пост не будет исключением.   Во-первых, задания на CTF по большей части отношения к TON и даже к блокчейну не имели. 3 задания на криптографию, реализованную на Tact (зачем?), задание на странную реализацию дерева Меркла, которое в TON просто бессмысленно реализовывать, т.к для этого есть встроенный механизм. По сути, как-либо относящихся к именно TON или хотя бы к технологии "блокчейн" заданий было 2 - "Dex" и "Airdrop" (это для тех, кто захочет порешать).  Во-вторых, к этому мероприятию очень странно был выбран регламент - зачем-то за 1, 2 и 3 решение давали бонусные очки. Так никто не делает в ctf-движении, это очень странный выбор, ведь мероприятие начиналось в 1 ночи по UTC, поэтому либо надо было вставать ночью и решать, либо ты был заведомо в пролёте, даже если быстрее остальных закончил с заданиями.  В-третьих, при всём при этом несмотря на заверения в каждом тексте задания о том, что используется приватный блокчейн, он приватным не был. Недобросовестный участник вполне мог подсмотреть чужие решения (путем парсинга чужих транзакций в блокчейне), тем более что почти все задания не требовали какого-то особого подхода, зависящего от адреса сдающего. Зачем тогда вы даёте доп баллы за 2 и 3 решение задания, если это решение можно просто подсмотреть? Учитывая, что за первые 4 места были денежные призы, не удивимся, если бы кто-то смухлевал.  В целом первым опытом таких мероприятий на TON мы довольны, но во второй раз на что-то подобное (именно по озвученным выше причинам) попасть бы не хотели. Не исключено, что мы сами в будущем организуем что-то такое, но пока загадывать не будем.  Скоро много нового. Stay tuned!

— 2024-10-01 —

Unknown: Разработчикам смарт-контрактов, которые с точки зрения логики оперируют с TON (например, принимают его в качестве оплаты), нужно всегда считаться с workchain адреса, с которым они оперируют. Допустим, вы разрабатываете смарт-контракт и рассчитываете комиссии на операции, хардкодите (чего делать вроде как не советуется, но все, кажется, делают) и проверяете их в коде контракта, а потом в том же коде отправляете транзакцию с точным значением TON на указанный пользователем адрес (с message mode 1 или, еще хуже, 65). В такой ситуации, если вы точно подгоняете комиссии, чтобы пользователь ни в коем случае не переплатил, этот же самый пользователь может вас обмануть.  Дело в том, что в блокчейне TON есть так называемые workchains. Обычно адреса, с которыми мы оперируем, начинаются с "0:". Этот 0 означает, что контракт функционирует в workchain с номером 0. Кроме нулевого, в TON также есть Masterchain, адреса которого начинаются с "-1" (например, вот). Он нужен для системных контрактов блокчейна, пользователи с ним взаимодействовать обычно не должны. Комиссии в Masterchain заметно выше (например, вот тут я заплатил за обычный перевод 0.012 TON при том, что обычно он стоит в 5-6 раз меньше), поэтому если в сообщении вы платите комиссию за пользователя, то пользователь может обмануть, указав адрес из Masterchain, таким образом потратив с вашего контракта больше, чем прислал и должен был получить.   Все это может привести к ошибкам с математикой, т.к ваш баланс на контракте уменьшается больше, чем вы ожидаете. А также в TON есть механизм удаления контрактов, которые не могут оплатить свое хранение в блокчейне, поэтому также это может привести к полной потере данных смарт-контракта. Поэтому даже если вы напрямую с TON не оперируете, эта уязвимость может вам сильно навредить.  Для исключения таких ошибок в контракте стандарта jetton используют функцию force_chain. Также, насколько я знаю, в FunC есть возможность ограничить затрачиваемый газ, но я в этом не разбираюсь, подскажите в комментариях.

Unknown: Если у кого-то есть отзывы по работе ton accelerator, обратитесь, пожалуйста, ко мне в личку, очень нужно проконсультироваться.

— 2024-10-04 —

Unknown: Выплаты за поставку ликвидности от DeDust.io  Многие наверняка видели, что DeDust спустя несколько лет всё же соизволил выплатить награды поставщикам ликвидности (те, которые не с фарма). Про то, насколько это невероятная вещь вообще говорить смысла мало, я лично недополучил около 1000$ из-за того что с момента вывода ликвидности из некоторых пар курс этих монет успел упасть во много раз 🙃.   Давайте лучше разберём более интересную вещь. Некоторые, возможно, заходили на DefiLlama и смотрели красивые графики проектов. Что мы знаем насчёт DeDust - поставщикам ликвидности он никаких денег не выплачивал, однако на графиках по прибыли протокола и собранным fees мы видим просто идеальную картинку - revenue протокола на протяжении всего времени был ровно 20% от общих собранных комиссий. Хотя, очевидно, это не может быть правдой - поставщикам ликвидности выплатили деньги только несколько дней назад, и то, по формулам, которые сложно понять наверняка.  Что же получается, DeFiLlama врёт нам? Краткий ответ - да.  Но всё не так просто. Чтобы DeFiLlama брала откуда-то информацию, авторы проектов должны написать свой так называемый адаптер. Все адаптеры хранятся в одном большом репозитории. В этих адаптерах авторы проектов сами пишут скрипты, чтобы подавать различную информацию о своих проектах (TVL, Revenue, Value flow и т.д).  Как же DeDust берёт информацию о собранных комиссиях и доходе протокола? Очень просто, со своей собственной API! Они просто берут свою собственную информацию о собранных комиссиях, и буквально умножают её в скрипте на 0.2. На самом деле из-за своей архитектуры они вынуждены делать тоже самое даже для расчёта TVL. Проверить, честно ли они это делают, очень сложно, однако мы можем попробовать посмотреть на tonalytica, где увидим TVL DeDust в 26.6m тон, то есть примерно $142.5m. Однако на DefiLlama через их API мы видим число в $189.99m на момент написания поста. Откуда взялись эти 47 миллионов долларов TVL? Предполагаю, что в TVL они также могут записывать средства, заблокированные на фарминг пулов, но наверняка знает только сама команда DeDust.  Стоит отметить, что это не выходящая из нормы практика, многие проекты делают также - те же STON.fi например (хотя у них различие между информацией с api и тоналитикой не такая существенная). Это в целом объяснимо, когда информация слишком сложная для получения из блокчейна напрямую. Хотя, например, у EVAA TVL берётся исключительно из блокчейна напрямую. Да и у команды Storm Trade получилось брать всю информацию кроме объёма торгов напрямую с блокчейна (TVL) и с redoubt (Fees, Revenue).  И как обычно, не стоит верить всем графикам в интернете, и проводите собственный dyor!

Unknown: В комментариях правильно написали что график и дата дефилламы по Revenue и Fees как раз есть только с момента, как Дедаст всё “починил”. Поэтому касательно этого графика возможно вопросов и нет.   Хотя опять же, исходного кода Dedust всё ещё нет, информация на дефилламу поступает только с собственной апи от Дедаста, можем только верить 😋  Поинт остаётся тем же - проверяйте откуда берётся информация на DeFiLlama, она может браться далеко не обязательно с блокчейна (reply to 48)

— 2024-10-15 —

Unknown: Мы не пропали, мы билдили!  Мы разрабатываем Bidask Protocol — DEX от TheOpenDevBlog!  Уникальность Bidask в том, что он первым на TON имплементирует концентрированную ликвидность: позволяет вкладывать ваши средства с гораздо большей эффективностью и гибко подстраиваться под свою финансовую стратегию. Больше можно почитать в whitepaper-е проекта на нашем сайте, там всё очень подробно описано!  Мы с удовольствем пообщаемся со всеми, кому будет интересен наш проект, а также презентуем Bidask Protocol на ближайшем буткемпе в Москве.  Шильте. Реактите. Интересуйтесь. @bidask — @TheOpenDevBlog

— 2024-10-20 —

Unknown: Скам жюри на вайтпейпер тут.   Ждите на афтерпати и в Питере 🤟🤟🤟

— 2024-10-24 —

Unknown: 🎉 Bidask Protocol — winner of the Moscow Bootcamp!  This Sunday, Moscow hosted one of the bootcamps from the Hackers League Hackathon 2024, and Bidask took first place! We extend our heartfelt thanks to everyone for their support and belief in our project, and we also congratulate the other finalists.   Out team continue to work and are looking forward to victory at the Hackaton final!  Join our new era of DeFi on TON! (forwarded from Bidask Protocol)

— 2024-10-30 —

Unknown: Мы давно ничего не писали в канал, т.к все темы для постов, записанные в заметки, требуют большого погружения и ресерча. Если вы хотите ускорить появление постов — закиньте нам звезд, но это не инвестиционная рекомендация.  НО! Нас можно будет найти на TON Gateway. Обсудить с нами желательно всё, но для удобства мы составили список активностей, в которых мы принимаем участие:  ⚫️ Мы очень активно заняты разработкой @bidask. Это наш основной проект, мы бросили на него все силы. Это очень серьёзный финансовый инструмент, который откроет пользователям на TON глаза на то, как реально должен использоваться DeFi. Мы открыты к сотрудничеству.  ⚫️Часть нашей команды участвует в разработке @circus_game. Это не наш проект, но мы в большой степени отвечаем за его техническую часть. Мы можем связать с владельцами для сотрудничества.  ⚫️ Мы готовы проводить аудиты и консультации. У нас крайне мощный бэкграунд в безопасности как web2, так и web3, а также возможность привлечь к проекту дополнительные силы в случае, если компетенций основной команды не хватает (крайне редко). Мы уже консультировали ряд крупных и очень крупных проектов в разных блокчейнах.  Наши контакты в био канала. До встречи! 🌞

— 2024-11-02 —

Unknown: Форк FunC би лайк:

— 2024-11-05 —

Unknown: На TON орудуют сэндвич боты.  Недавно ко мне обратились с проблемой — якобы в TON есть рабочий MEV. И им постоянно бреют работяг при покупке низколиквидных токенов. Как это работает: вы пытаетесь свапнуть токен на DEX или агрегаторе, отправляете транзакцию, а потом видите, что кто-то в блокчейне купил прямо перед вами и продал сразу после вас.   Я этим очень заинтересовался, поскольку все мы знаем, что MEV-а на TON не существует, но при этом боты довольно стабильно встают до пользователя и сразу после. Начал разбираться.  Выяснилось, конечно, что никакой это не MEV, а сэндвич боты работают по принципу обыкновенных снайперов: ⚫️ Они используют кошелёк в том же шарде, что и vault дедаста или роутер ston fi. Этим они обгоняют большинство аккаунтов в сети, ведь на сообщение из одного шарда в другой тратится гораздо больше времени, чем если всё происходит в одном. ⚫️Если кошелек пользователя находится в одном шарде с контрактами DEX-ов, снайперы отправляют сообщение сразу с нескольких кошельков, тем самым увеличивая шансы на обгон пользователя просто за счёт количества. При этом повторной покупки не случается, т.к у них настроен slippage, и проходит ровно один свап. Поэтому боты выглядят в блокчейне как на картинке. ⚫️Если пользователя снайпят через dedust, то в сообщении сразу происходит обратный свап, как тут. Кошелёк отправил на DEX тоны, и в той же цепочке сообщений получил в ответ чуть больше тонов. Бесплатные деньги, не иначе.  Мы проконсультировали независимую команду разработчиков, и они пообещали в скором времени выкатить решение для обхода этой проблемы. Подробности раскрывать не можем, т.к, очевидно, снайперы могут к ним приготовиться. Поэтому мы, как и все, ждём анонса.  @TheOpenDevBlog

— 2024-11-10 —

Unknown: Сегодня мы выпустили пост про иную модель проскальзывания (slippage-а), которую мы имплементировали в @bidask.  При обмене токенов через автоматический маркет-мейкер (AMM) цена, по которой происходит обмен, испытывает движение в невыгодную сторону, называемое проскальзыванием. Пользователи имеют возможность указывать допустимое проскальзывание, чтобы не совершить невыгодный обмен или не стать жертвой сэндвич-атаки.  В EVM-сетях и на v2 DEX мы привыкли, что выход за границы указанной цены полностью откатывает всю транзакцию, как будто пользователь не совершал обмен и не тратил токенов.  В Bidask Protocol, в силу мультиконтрактной архитектуры протокола и атомарности транзакций в тоне, такое невозможно, ведь свап может затрагивать несколько контрактов с ликвидностью. Чтобы сделать "нормальный" slippage, пришлось бы идти обратно по всем контрактам и "отменять" транзакцию, и еще учитывать, что другой пользователь уже мог начать обменивать после нас. Это очень непрактично и дорого, поэтому мы поступили хитрее.  Вместо этого, свап в Bidask Protocol осуществляется по модели partial execution, при которой токены обмениваются до тех пор, пока цена устраивает пользователя, т.е. не превышает указанный slippage. Пользователь получает токены нового актива, которые удалось свапнуть, и несвапнутые токены старого.  С точки зрения пользовательского опыта это всё тот же slippage, даже удобнее, потому что вы не испытаете слетевших транзакций и потратите меньше газа, если вдруг фронтэнд показывает цену с задержкой или на рынке большая волатильность.  @bidask — @TheOpenDevBlog

— 2024-11-12 —

Unknown: В комментариях спросили, как получить адрес в конкретном шарде. Мы решили подойти к вопросу обстоятельно, и запилили для вас простую страничку.  На ней вы можете вставить нужный вам адрес, и набрутить себе кошелёк в том же шарде блокчейна. Осторожно, это может занять больше 5 секунд! На выходе вы получите адрес вашего нового кошелька и seed фразу для него (как на картинке).  Важно понимать, что наличие такого кошелька не убережёт вас от снайпинга, но сильно повысит ваши шансы быть первее других пользователей при обмене токенов.  Важно!!! Сайт не собирает seed фразы, все вычисления происходят в вашем браузере, но если вам особенно важна безопасность, то поднимите страничку локально, использовав ее исходный код.  @bidask x @TheOpenDevBlog (reply to 59)

— 2024-11-13 —

Unknown: Отвечаем на популярные вопросы о сэндвич ботах:  Почему это не MEV-боты?  🔥: MEV - это механизм, с помощью которого валидатор (майнер) может извлекать прибыль, манипулируя порядком транзакций в блоке. MEV-а в нашем блокчейне пока нет, но он обязательно появится, когда придут большие объемы. Чтобы оценить масштабы реального MEV-а, предлагаем вам прочитать статью, как сэндвич бот заплатил 46 ETH (>100к$) за одну транзакцию в виде комиссии. Конечно, существует вероятность, что валидаторы сговорились и бреют всех нас на 3-5 TON на обмене низколиквидных токенов, но она ничтожно мала. _____________ Как узнать, что адреса находятся в одном шарде?  🔥: по первым битам адреса. Например: мы хотим проверить, находятся ли адреса EQDa4VOnTYlLvDJ0gZjNYm5PXfSmmtL6Vs6A_CZEtXCNICq_ и EQDSEqIDjlGdDvoqHJ_wTk6wRvgXwvE05QbCydqOEOpjpbhU в одном шарде. Мы переходим на нашу страничку, вставляем поочередно эти два адреса и видим, что у обоих шард - 1101. Значит — они находятся в одном шарде.  Важно: блокчейн может быть не нагружен, и в такие моменты количество шардов сокращается, и количество бит, нужных для проверки шарда, тоже сокращается, но всё равно советуем вам всегда смотреть на 4 бита и не париться. В данный момент максимальное количество шардов - 16 (4 бита), и если в будущем это число увеличится, то мы отредактируем наш сайт под новые требования. _____________ Если я хочу обменивать жеттоны быстрее всех, какой кошелек мне нужно иметь?  🔥: Нужно иметь такой wallet, чтобы и он, и ваш jetton-wallet были в одном шарде с jetton-wallet, принадлежащем DEX. Важно: в одном шарде не с vault дедаста или router ston fi, а именно с их jetton-wallet-ами. Сделать это можно, генерируя себе wallet через наш сайт до тех пор, пока ваш jetton-wallet нужного вам жеттона не совпадёт шардом с jetton-wallet биржи. В случае с TON всё просто - для dedust ищите адрес в шарде с vault, в случае со ston fi - в шарде с pTON (для v1, про v2 расскажут в комментах)  @bidask x @TheOpenDevBlog

— 2024-12-07 —

Unknown: Долгое время благодаря не разбирающимся в технологии людям существовал нарратив о том, что концентрированная ликвидность на TON невозможна. Конечно, это было неправдой, и такие выводы приходили людям только потому, что они очень плоско смотрели на возможности блокчейна. В своё время именно благодаря этому нарративу мы решили сделать @bidask.  Однако какой финансовый механизм на блокчейне TON действительно нереализуем? Ответ — flash loans.   Перевод вас не собьёт с толку, это буквально «мгновенный кредит». В крипте мы привыкли, что кредиты нам выдают только под залог наших средств, как это происходит на AAVE или EVAA. Но благодаря технологичному подходу к управлению средствами на EVM сетях появился способ занять деньги, провести с ними некоторую манипуляцию, и вернуть обратно с процентами в рамках одной транзакции. Если у вас не получится вернуть деньги, вам просто не выдадут кредит. Из-за того, что вся цепочка транзакции в EVM сетях происходит «одновременно», конечный результат исполнения можно проверить. Это нонсенс, кредит с нулевым риском, ведь фактически заёмщик возвращает кредит моментально сразу после его взятия.  В мирных целях flash loans нужны, например, арбитражерам, если они видят большой спред на двух разных DEX, но покрыть его своими средствами не могут. В такой ситуации можно взять мгновенный кредит, проарбитражить, и вернуть с процентом какую угодно сумму, разницу забрать себе. Этот механизм доступен практически каждому, кто способен искать вилки и писать смарт контракты.  На TON сообщения движутся асинхронно, и нельзя проверить результат всей цепочки исполнения, находясь в её начале. Из-за этого механизм flash loan-а в чистом виде абсолютно нереализуем. Flash loan — потеря для экосистемы, однако асинхронность и шардирование блокчейна — ещё большие приобретения.   Кстати, очень часто flash loan использовался для атак на DeFi. Подробнее об этом можно почитать тут.  @bidask x @TheOpenDevBlog

— 2024-12-09 —

Unknown: Известно, что Tether на EVM блокчейнах умеет блокировать или изымать USDT на кошельках, если посчитает это нужным. Обычно это происходит при совершении каких либо преступлений владельцем кошелька.  TON этот механизм не обошел стороной, у jetton wallet USDT тоже есть опция быть заблокированным. Собственно, поэтому стандарт в tonviewer подписывается как «jetton wallet governed». Но вот к реализации этого механизма есть вопросы. На EVM сетях всё просто — у токена есть один единственный смарт контракт, при обращении к нему нужный адрес блокируется. В TON всё не так, и чтобы заблокировать баланс конкретного адреса, нужно обратиться напрямую к его jetton wallet-у.   Это происходит так: админ Tether USDT обращается к jetton master, jetton master обращается к нужному jetton wallet, jetton wallet блокируется. Проблема данного механизма в том, что уже на этапе транзакции к jetton master злоумышленник может переместить свои токены на другой кошелек, или вовсе продать их на DEX, и выйти в TON. Достаточно лишь следить за транзакциями на jetton master и искать там сообщения на изменение статуса своего кошелька. Проблема усугубится, если jetton wallet злоумышленника находится в другом шарде относительно jetton master USDT. Тогда вообще «заснайпить» блокировку кошелька совершенно несложно, ведь транзакция из одного шарда в другой будет идти достаточно долго.   Прецедентов блокировки USDT на TON пока не было, мы проверили. Думайте.  @bidask x @TheOpenDevBlog

— 2024-12-17 —

Unknown: Принято считать, что на TON невозможен MEV — Maximal Extractable Value (или как он ранее расшифровывался, Miner Extractable Value) — механизм "подкупа" валидаторов через увеличение выплачиваемой им комиссии с целью выгодной для подкупающего манипуляции порядком транзакций в блоке. Это используется, например, для получения преимущества перед другими при арбитраже, ликвидациях, или например в знаменитых "сэндвич"-атаках, при которых валидатор помещает транзакцию "жертвы" между транзакциями атакующего — отсюда, собственно, и название.  В TON комиссии за транзакцию фиксированы, высокий спрос регулируется шардингом. Поэтому варьировать комиссию, как на EVM, не получится. А переменные по типу block.coinbase в Solidity (адрес кошелька валидатора, выпускающего блок) контрактам на TON недоступны. Конечно, остаётся возможность договориться с валидатором лично, но это не стандартизированный подход. В документации TVM есть обещание добавить команду BUYGAS, но никаких подробностей не дают.  Когда вы совершаете действие через обычный кошелек, вы посылаете ему сообщение, а перед ним 512 бит, которые отвечают за подпись вашего сообщения. Таким образом, никто, включая валидатора, не может поменять ваше действие, ведь тогда ваша подпись станет недействительной. Приватный ключ от wallet-а хранится только у вас. Таким образом гарантируется, что контроль над вашим кошельком имеете только вы.  🔥 Отсюда рождается новая идея — MEV-кошелек. Задумка в том, чтобы добавить в тело сообщения место, которое не покрывается подписью, а следовательно даёт валидатору возможность вписать туда любое значение при выгрузке из мемпула, а именно — адрес своего кошелька. Например, на скрине считываемый validator_reward_address не попадает в подписанное тело сообщения для wallet w5, поэтому валидатор может его подменить.  Такой механизм, в отличие от простого увеличения комиссии, открывает возможность условной выплаты, то есть, например, только в случае, если операция, ради которой платилась взятка, действительно закончилась финансовой выгодой. Это может проверяться при получении результатов атаки на кошельке. Валидатор таким образом становится сам заинтересован в наиболее эффективном расположении транзакции.  Однако для функционирования подобного кошелька требуется модификация софта, которым пользуются валидаторы, для того, чтобы автоматически обрабатывать транзакции на подобные кошельки и подставлять нужный адрес, а также сортировать их для поиска собственной выгоды.  Пускай данный пост, а также экономический интерес подстегнёт подобную разработку. Приносим извинения за доставленные неудобства!  @bidask x @TheOpenDevBlog

— 2024-12-31 —

Unknown: 🔥🎉 @TheOpenDevBlog подводит итоги.  Год получился, как это обычно бывает, насыщенным. Николай Дуров, наконец, передумал и решил, что в Cell будет 1025 бит, а в Int — 255. Сказал, что "перепутал и не понял, как так получилось, а тут как раз повод — 2025 год".  Мы появились, подписали на себя самых крутых персон в экосистеме TON, выполнили несколько крупных заказов и, наконец, разработали @bidask.  У нас есть очень большие новости сразу по ряду направлений, которыми мы пока не можем делиться, однако можем заверить — в 2025 году мы приумножим свой успех и расскажем вам ещё больше нового!  Вам остается только ждать, поздравлять нас звездами и репостами, бесплатным шиллом по приваткам и вашими респектами.  🩵 Спасибо вам за этот прекрасный (полу)год! Поздравляем вас и ваших близких с Новым Годом, пусть в нём всех нас ждет TON по 20, и Solana по 0, конечно же.   Думайте. @TheOpenDevBlog

— 2025-01-11 —

Unknown: 🔥 Сколько мы бы не защищали тут TON, культура разработки в нашем блокчейне ещё на совсем низком уровне. На EVM сетях есть большое количество стандартов, заточенных под решение разных проблем — от обычных токенов до ERC-1155, который совмещает в себе токены и NFT. Идея выпуска стандартов перекочевала и на TON, однако, как будто, с фальстартом, поскольку к ним уже сейчас есть множество вопросов. В этом посте вместе с @pcrafter разберем TEP-74, стандарт жетона, его проблемы, что в нём можно поменять, и как его дополнить:  ⚫️ В нынешнем стандарте нет опции не деплоить jetton-wallet получателя. Это было бы полезно для того, чтобы уменьшить стоимость пересылки жетонов в случае, если у получателя уже есть кошелек. Решение может быть простое — иметь в интерфейсе посылания жетонов такую опцию, которая будет автоматически заполняться кошельками (tonkeeper и т.д) для удобства пользователя.  ⚫️ Нынешний стандарт вообще не поддерживает работу с балансом jetton-wallet. Ни возможности ончейн узнать, сколько у тебя жетонов, ни возможности отправить сразу все жетоны, сколько бы их там не было, нет. Это очень сильно ограничивает при написании смарт-контрактов, работающих с жетонами. Кроме того, неясна роль excess-сообщений. Кроме возврата TON, они могли бы нести информацию хотя бы о количестве присылаемых токенов, но сейчас, если контракт-источник не послал forward_ton_amount, то ончейн узнать о пришедших жетонах нельзя.  Это, например, очень сильно ограничивало во взаимодействиях со ston-fi v1, ведь там контракт роутера по умолчанию слал жетоны с forward_ton_amount, равным 0, и не было никакой возможности оперировать с пришедшими от свапа жетонами. Фактически, это делало ончейн взаимодействие с протоколом невозможным.  ⚫️TEP-74 поддерживает forward payload, но не поддерживает возможность деплоить контракт получателя. А представьте, как было бы удобно! Можешь сразу деплоить контракт по ту сторону, исполнить его, и получить результат.   ⚫️ Хранение своего кода в стейте контракта не обязательно. Мало кто знает (мы сами узнали совсем недавно), что в TVM есть инструкция MYCODE, которая позволяет контракту получать свой собственный код в виде cell.  ⚫️ Кажется, что контракт jetton-wallet оставляет себе слишком много TON для газа. Например, в @bidask стоимость свапа в рамках одного бина составляет 0.06 TON, из которых 0.01(а то и все 0.02) остаются мертвым грузом на jetton-wallet-ах. Посмотрите на jetton-wallet-ы на DEX, на любом активно использующемся контракте лежит много навсегда заблокированных TON. Например, на кошельке USDT dedust лежит 6к$ в оставшихся комиссиях.  И при этом альтернатив нет. С нынешними жетонами, которые минтятся на minter.ton.org и т.д (даже с USDT), крайне сложно работать.   Меняйте TON. Не на USDT. @TheOpenDevBlog

— 2025-02-01 —

Unknown: 🔥 Перед очень большими новостями небольшой лайфхак вам на затравку.  Как бесплатно достать ключ для tonapi? Взять его в tonkeeper!  Заходим сюда (ссылка была получена через вкладку network в инспекторе - при каждом обновлении интерфейса приложение делает туда запрос) и берем ключ из параметра tonApiV2Key. Там же можно найти и эндпоинт для tonapi — keeper.tonapi.io. Может, у него аптайм выше стандартного)  Ключ лимитирован 100 запросами в секунду, но только для одного ip (подсчитано вручную, не точно). Для сравнения — бесплатный tonapi (без ключа) можно использовать только 1 раз в секунду.  Вообще, так можно позаимствовать ключ у какого угодно проекта, который использует tonapi на фронтенде. Стоимость ключа для проекта от активности не повышается, поэтому вы таким образом никому не навредите.   Также стоит помнить, что ключи tonapi могут быть ограничены по Origin (домен сайта с которого должны отправляться запросы). В случае с tonkeeper это не так, а если найденный ключ всё же ограничен по домену — для использования его вне браузеров всегда можно добавить требуемый домен в header Origin.  The Open Network. @TheOpenDevBlog

— 2025-02-12 —

Unknown: 👍 DWF Labs х Bidask  😱😱😱😱😱

— 2025-03-05 —

Unknown: 🔥 Делимся находками в процессе разработки @bidask  Многие разработчики на TON думают, что мод 64 в сообщении гарантирует, что баланс контракта останется таким же, как и до сообщения. И модом 64 они прикрываются, когда нужно отправить ровно 1 сообщение, не поменяв баланс контракта. Короче, используют мод 64 как гарант, что контракт со временем не обнулит свой баланс.  Ирония в том, что на самом деле мод 64 гарантирует, что баланс контракта НЕ УВЕЛИЧИТСЯ.  А всё дело в storage fee. Нюанс в том, что storage fee (плата за хранение информации в блокчейне) взимается с контракта до запуска TVM, то есть контролировать или отследить этот процесс невозможно. Таким образом, мод 64 рассчитывает, что баланс контракта останется таким же, как и ПОСЛЕ снятия storage fee с баланса. То есть balance_after <= balance_before.  Решений много, но глобально они все опираются на механизм raw_reserve и мод сообщения 128.  Для того, чтобы держать баланс контракта всегда одинаковым, нужно при каждом вызове, где нужно будет отправить сообщение, использовать raw_reserve(<нужный баланс>, 0), а в самом последнем сообщении на контракте использовать мод 128. Таким образом, последнее сообщение заберет с собой все остатки баланса, кроме зарезервированного, и это гарантирует (почти), что баланс контракта не изменится. При таком решении очень важно понимать, что пользователь может прислать недостаточно газа (с учетом storage fee), и контракт упадет, потому что ему либо не хватит на резерв, либо на сообщение. Вообще, у raw_reserve тоже есть разные моды, советуем ознакомиться.  @TheOpenDevBlog

— 2025-04-01 —

Unknown: 1 апреля нет большей шутки, чем выложить пост.  @bidask успешно проходит аудит, а мы тем временем решили накодить приколюху для нашего любимого TON-а.  Все мы знаем, что валидаторы плохо кушают, поэтому давайте их поздравим с праздником — днём математика!  Для этого команда @TheOpenDevBlog подготовила адрес, куда можно донатить валидаторам. Смарт-контракт сжигает на газ весь TON, что ему пришлют. Мы поздравили первыми!  Кроме того, отправка туда ваших TON повысит TPS сети, а это не менее важно.  Будьте внимательны — никто не сможет вернуть вам TON, если вы отправите его на этот адрес.  В комментах предлагаем обсудить все способы обмануть контракт. Закрывайте спойлерами ответы)  UPD: в комментах напомнили, что половина комиссий сжигается, поэтому таким образом мы еще и уменьшаем эмиссию TON!  In community we trust. @TheOpenDevBlog

— 2025-04-26 —

Unknown: 🔥 Главная идея DEX с концентрированной ликвидностью — это эффективность использования капитала. Но что такое вообще эффективность капитала?   Проще всего её представить в контексте обычной модели Uniswap. Предположим, пользователь открывает позицию на $10к на пару ETH\USDT в пуле с LP fee 0.3% на средний диапазон (1500-2000). Спустя месяц количество заработанных комиссий у него составляет приблизительно $600 (реальные числа с revert.finance). Таким образом его капитал за месяц был использован для свапов на общую сумму равную 600/0.003 = $200к, то есть полностью 20 раз!  Если же зайти на любой CPMM DEX, то там капитал на любой аналогичной высоколиквидной паре за месяц будет использован точно в разы меньше.   Остаётся вопрос: как ещё можно увеличивать показатель эффективности капитала?   Первый вариант — это манипулирование уровнями комиссий в пуле. Например очевидно, что если комиссий вообще не будет (ни комиссий протокола, ни комиссий для провайдеров ликвидности) — то почти наверняка вырастут объёмы торгов и эффективность капитала как следствие (если забыть, что комиссий мы не получим 😀). Комиссии lp провайдеров убирать бессмысленно, а вот с комиссиями протокола разъяснять долго — есть очень подробный ресёрч при содействии Uniswap Foundation на эту тему. Существует также опция использования динамических комиссий, больше всего в этом преуспела Meteora на солане — и её успешный опыт мы активно перенимаем в @bidask.  Очень важной опцией является использование автоматического реинвестирования заработанных комиссий обратно в позицию ликвидности. Да, это работает само собой в любом CPMM DEX, однако для CLMM это редкость, хотя это дает ощутимый прирост к доходности.  Предположим, вы просто положили деньги в банк под 12% годовых. Если вы получаете их ровно раз в год, то ваша доходность за год будет составлять как раз 12%. Если же будете получать их каждый месяц и реинвестировать - доходность будет уже ~12.68%, если же реинвестирование будет происходить непрерывно то это уже ~12.74%. Формула для подсчета APY при непрерывном реинвестировании: e^APR - 1.   Казалось бы, разница не такая большая для 12% годовых, чтобы о ней думать. Однако если представить ситуацию, которая вполне возможна при поставке концентрированной ликвидности на достаточно широкий диапазон, что актуальная цена не вышла из него в течении года — это будут вполне реалистичные 20-30% годовых.  Для 30% годовых непрерывное реинвестирование комиссий приведёт уже к 35% годовым вместо 30%, к 64% вместо 50% без реинвестирования, и так далее.   Учитывая, что существуют киты, которые не так следят за IL, а лишь ждут, пока комиссии полностью не окупят вкладываемую ими ликвидность — подобный буст процентов доходности вполне может сократить годик-другой до цели в 100% ROI.  Над всем этим мы думали на старте разработки @bidask — и реализовали автоматическое реинвестирование комиссий. И даже у невероятно крутой Meteora, с которой нас принято сравнивать, такой киллер фичи нет — в этом мы круче.

— 2025-04-29 —

Unknown: 🔥 Нас можно будет найти на Token 2049.  Наши контакты в био канала. До встречи! 🌞

— 2025-05-05 —

Unknown: 🔥 Пока в TON, как обычно, происходит балаган, устроим себе пикник во время пира — расскажем про интересный, но уходящий от нас нюанс в разработке смарт контрактов на нашем любимом устаревшем отставшем от жизни и времени и всех конкурентов недоязыке программирования FunC.  В некоторых проектах может потребоваться проверить, что один адрес НЕ равен другому. Многие эту проблему решают очень просто:  ifnot (equal_slices(address1, address2))  Фатальная ошибка.  Нюанс кроется буквально в названии функции — equal_slices не проверяет равенство адресов, она проверяет равенство слайсов.  Дело в том, что в TON существует больше одного способа записать адрес в slice, чтобы он корректно считался ~load_msg_addr — addr_std и addr_var. Если записать адрес двумя разными способами, а потом считать, то получится два разных, не равных друг другу слайса, хотя адрес один.  Что же делать?  На самом деле, решение простое — кроме equal_slices также проверять, что длина адресов — 267 бит, ведь это длина addr_std.  Нюанс кажется местячковым, но олды знают и помнят, что именно благодаря нему в TON уже происходили взломы.  К сожалению или к счастью, addr_var очень скоро нас покинет. Наши репортеры и очевидцы из тестнета утверждают, что там он уже "пропал" 🫡🫡🫡  Крутая ироничная фраза. @TheOpenDevBlog

— 2025-05-09 —

Unknown: 🔥 Мы пообщались с @kyouma из Ton Tech, чтобы выяснить подробности грядущего обновления TON, связанного с новой системой распределения контрактов по шардам.  Главной проблемой, которую и решали мы в @bidask, было то, что система распределения контрактов по шардам была строго детерминированной — брался хэш от state init, получался адрес контракта, и после этого по первым битам адреса определялось, в каком шарде будет контракт. Из-за этого все операции в TON были заметно дольше — ведь транзакция пользователя постоянно "прыгала" по шардам даже там, где это совершенно не нужно.  Решением для этого должны были стать anycast адреса. Не удивляйтесь, если ничего о них не слышали — они больше не поддерживаются. Это механизм, благодаря которому контракты могли делиться и соединяться вместе с шардами для распределения нагрузки на сеть.   На их основе даже был сделан DEX, позволяющий проводить обмены в рамках одного блока. Там не было использовано фишки со сплитом контрактов, просто были точки входа в DEX во всех шардах. Минусом такого подхода было деление ликвидности пар на все шарды и закономерное увеличение слипаджа. Немногие знают, но mainnet версия bidask, хоть и начала писаться до появления LUXNOX, во многом была вдохновлена именно этим решением. Мы следим за экосистемой 🤟  Как эту проблему решили? Теперь в state init появился новый параметр — fixed_prefix_length. Он дает понять, какое количество бит в начале адреса при деплое можно перезаписать, чтобы контролировать, в какой шард пойдет контракт.  На счет обратной совместимости можно не переживать — на месте fixed_prefix_length раньше был другой, по сути бесполезный параметр, связанный с anycast, поэтому с точки зрения построения state init ничего глобально не изменилось.  При всей кажущейся простоте изменения это, конечно, открывает пространство для множества вещей. Первое, что приходит в голову — jetton, который создает jetton wallet всегда в 1 шарде с контрактом кошелька пользователя. Нам, как разработчикам, это еще вселяет надежду, что наконец кто-то займется обновлением стандарта jetton, который явно морально устарел.  Это сильно улучшит опыт взаимодействия с DeFi, ведь теперь протоколы могут контролировать ончейн, без брутфорса, что будут в 1 шарде. Не сразу, но это принесёт значимые плоды.  @TheOpenDevBlog

— 2025-05-12 —

Unknown: 🔥 GM Подкиньте — какой у кого есть тулинг под FunC?  Пойдет что угодно. Го обмениваться опытом

— 2025-05-15 —

Unknown: 🔥 Мы ищем контакты с трейдинг командами.   @bidask есть что предложить: мы быстрее, мы эффективнее, мы дешевле. Мы готовы помочь с интеграцией, стратегиями, с чем угодно, что у вас вызывает трудности при интеграции нового DEX.  Считайте этот пост публичной рефералкой, мы будем крайне благодарны, если по вашей рекомендации или репосту к нам придет будущий партнер.

— 2025-05-23 —

Unknown: 🅱️ Кидаем скрины скорости свапов, поехали  LFG  https://app.bidask.finance/

— 2025-05-24 —

Unknown: 🌞 Отвечаем на вопросы про вчерашний релиз @bidask:  Вы обещали свап за 0 секунд, выходит за 15, почти как у других дексов.  🔥  До релиза @bidask обычные(!) трейдеры в выборе адреса своего кошелька полагались на удачу. Это неправильно. В TON очень важен кошелек, с которого вы проводите операции. Дело в том, что TON умеет шардироваться (делиться на части) при больших нагрузках. В данный момент нагрузки нет, поэтому сейчас, скорее всего, в районе 2-4 шардов всего (при 16 максимальных). Сообщения между шардами тратят время, именно поэтому в пики активности свапы в TON раньше длились по минуте-полторы. Если такие нагрузки вернутся в наш блокчейн сейчас, то @bidask этого не почувствует, в отличие от других DEX, поскольку он шард-оптимизирован.  Продвинутые трейдеры брутят себе кошельки, которые: 1) находятся в 1 шарде с протоколом, который им нужен. 2) совпадают шардом с jetton wallet, который нужен для операций в нужном протоколе.  @bidask, в отличие от других дексов на TON, при таком подходе позволяет делать свапы буквально моментально с точки зрения блокчейна. Независимый от нашего участия пример уже есть. Важно, что даже при такой скорости в tonviewer пользователь ждет 10-15 секунд, пока кошелек обработает ончейн данные. Это от нас не зависит. Отметим, что одной из главных целей TON Core в 2025 году является уменьшение end-to-end latency, то есть как раз уменьшение задержек индексации блокчейна кошельками и приложениями. ЖДЕМ 😐  Мы обязательно сделаем тулзу, которая позволит подбирать кошельки для пулов @bidask, для реального раскрытия потенциала протокола для каждого юзера! ___ Где прочитать документацию протокола?  🔥 На docs.bidask.finance. ___ Tonkeeper пишет комиссию свапа 0.45 TON, это очень много, почему так?  🔥 Мы не знаем. Реальная комиссия сети — 0.04 TON за свап в рамках 1 бина, что крайне низко для такого комплексного протокола с таким количеством фич. По какой причине Tonkeeper (и, возможно, другие кошельки) завышает комиссию, нам непонятно, очень надеемся, что это исправят!  Мы разработчики этого протокола, задавайте вопросы. @TheOpenDevBlog

— 2025-06-10 —

Unknown: 🔥 Вчера Павел Дуров сделал сенсационное заявление — TON стал №1 блокчейном по объему трейдинга NFT, если считать off-chain сделки.  Многие посмеялись, посчитали это забавным предложением, но знаете ли вы, что существует стандарт токена (а соответственно, и NFT), который можно передать off-chain?  Это — ERC-965, стандарт токена для EVM сетей (есть более известный аналог — ERC20Permit). Вкратце суть такая — своим приватным ключом вы подписываете некоторую информацию, передаете получившееся как угодно (хоть сообщением в телеграме) другому юзеру, а он со своего Ethereum кошелька может предъявить в смарт контракт этот "чек" и забрать токены. А может не забирать, подождать (хотя вроде это небезопасно). Этот стандарт нужен для того, чтобы пользователь, передающий токены, не платил за газ (что-то знакомое 🤔)  По сути, это аналог выписывания чека, чтобы получатель должен был самостоятельно зайти в банк и его обналичить. Забавно, что функция в proposal так и называется — sendByCheque.  С переносом данного стандарта в TON есть некоторая проблема. Дело в том, что в Ethereum сущности смарт-контракта и кошелька пользователя (External Owned Account — EOA) разделены. Таким образом, если у вас есть приватный ключ, вы точно знаете, какой кошелек (адрес) в EVM сети ему соответствует. При предъявлении чека токен использует функцию ECRECOVER, восстанавливает кошелек (адрес) отправителя, и переводит его токены владельцу чека. В TON всё является смарт-контрактом, поэтому однозначно восстановить по подписи адрес затруднительно. Однако всегда можно что то придумать, если будет нужно.  😐 Так что, наверное, Ethereum является топ-1 блокчейном мира по off-chain передаче токенов. Пока. @TheOpenDevBlog

— 2025-06-19 —

Unknown: 🔥 Наш блог меняет TON.  Уже довольно давно мы писали обзор на (на наш взгляд) устаревший стандарт жетона, и спустя некоторое время выяснилось, что наш разбор приняла во внимание команда TON Studio! Они выпустили стандарт «богатого на фичи» жетона (так и называется), в который имплементировали возможность:  ⚫️ Деплоя контракта через трансфер жетона ⚫️ Отправки всех жетонов (shut up and take my money) ⚫️ Отказа от деплоя jetton wallet получателя  Реализовано это через заранее предусмотренное поле custom_payload (которое почти не использовалось) у любых жетонов. Отправляешь нужный mode (первые 32 бита custom_payload), и jetton wallet формирует сообщение в соответствии с заданным модом. Минтлесс жетон в такой ситуации остается out-of-scope, планов совмещать эти два стандарта пока нет (да и надо ли?)  Контракты, разумеется, написаны на tact, репа тут, берегитесь комментов под постом.  Кстати, по соседству находится шард оптимизированный жетон (jetton wallet всегда находится в 1 шарде с владельцем), который, видимо, станет новым основным стандартом жетона в самом скором времени (не обязательно имплементация на tact).  Мы в @bidask недавно воспользовались контрактами NFT на tact, и остались довольны. Будем сотрудничать и поддерживать Ton Studio и дальше — они делают крутую работу.  Богатейте фичами, а не мемами @TheOpenDevBlog

— 2025-07-06 —

Unknown: 🔥 Как работает концентрированная ликвидность.  TON привносит реальный масс адопшн, и многие из TON энтузиастов никогда не пользовались никакими криптопродуктами за пределами нашего блокчейна. Поэтому давайте расскажем, как работает концентрированная ликвидность, чтобы было проще в неё заходить.  Обычные DEX, к которым на TON уже привыкли (их еще называют CPMM — constant product market maker) работают по простейшей формуле — есть количество токена X, количество токена Y, до свапа есть инвариант: X * Y == k. Пользователь присылает сколько то токенов, и DEX должен вычислить такое число выходящих токенов, чтобы после проведения операции значение X * Y == k сохранилось. После этого или перед этим берутся комиссии, это не принципиально, основной принцип таков. Почитать подробнее можно тут.  Это очень простая мат. модель, она работает для почти любых количеств токенов, но эволюция DeFi привела к появлению механики, гораздо более эффективно использующей ликвидность.  CLMM — concentrated liquidity market maker, усложняет механизм CPMM. Он вводит понятие диапазонов. Теперь предоставить ликвидность можно так, чтобы она использовалась только при торговле в определённом диапазоне цены, или "сконценрировать" её. Такой подход приоритизирует сконцентрированную ликвидность над всей остальной и позволяет получать гораздо больше комиссий при меньшем капитале. Эта механика вводит в действие целую новую "рыночную игру": теперь провайдеры ликвидности соревнуются в том, кто корректно предскажет цену и получит от этого выгоду, открывая пользователям ещё один способ заработать.  Помимо этого, концентрация ликвидности означает, что теперь нужно больше объёмов, чтобы сдвинуть цену, так как почти вся ликвидность в пуле сконцентрирована вокруг неё, и она будет использоваться, пока полностью не исчерпается. Иными словами, уменьшается slippage при свапе. Таким образом, концентрация ликвидности дает преимущество не только провайдерам, но и обменивающим.  Ввиду ограничений смарт-контрактов, на практике CLMM обычно реализуется через так называемые бины. Если предельно упрощать (в разных моделях по разному бывает), то бин — это маленький CPMM пул, который оперирует в рамках небольшого отрезка цены. Если вы зайдёте на @bidask в любой пул, то увидите график ликвидности. Каждый столбик на этом графике — это бин, у него есть своя ликвидность, и ликвидность у соседних бинов никак не пересекается.   Таким образом, если торги происходят в бине, в котором у вас лежит ликвидность, вы получаете неплохой процент на неё, однако если цена не в ваших бинах, вы ничего не получаете. Чем у́же выбранный вами диапазон — тем больше все зависит от того, насколько хорошо вы угадываете цену на будущем рынке, и наоборот — существуют стратегии предоставления ликвидности на очень широкие диапазоны, которые годами получают стабильные 15-20% годовых при минимальных рисках.  Разбирайтесь. @TheOpenDevBlog